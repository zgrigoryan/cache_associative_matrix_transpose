# Matrix Transposition Benchmark

This project demonstrates two different matrix transposition methods in C++:
- **Naive Transposition:** A simple element-by-element transposition.
- **Blocked Transposition:** A cache-friendly version that processes the matrix in blocks to improve cache utilization.

The program uses the [Kaizen library](https://github.com/heinsaar/kaizen/tree/master) for command-line argument parsing to allow user customization of parameters like the matrix dimension and block sizes.

## Features

- **User Configurable Matrix Size**  
  Specify the size of the square matrix using the `--size` option.  
  *Example:* `--size 2048`

- **Custom Block Sizes**  
  Supply a comma-separated list of block sizes using the `--block-sizes` option.  
  *Example:* `--block-sizes 8,16,32,64`

- **Benchmarking**  
  The program measures and outputs the execution time (in milliseconds) for both the naive and the blocked transposition methods, allowing you to observe the performance impact of cache optimization.

- **Result Verification**  
  After each blocked transposition, the result is verified against the naive transposition to ensure correctness.

- **Formatted Output**  
  The results are presented in a neatly formatted table.

## Prerequisites

- A **C++ compiler** supporting **C++17** or later (e.g. GCC 7+, Clang 5+, or MSVC 2017+).
- The **Kaizen library** must be available on your system (ensure that the header `kaizen.h` is in your include path).

> **Note:** If you see errors related to `<filesystem>`, `if constexpr`, fold expressions, or `std::optional`, it’s likely your compiler version is too old or you are not compiling with C++17. 

## Build Instructions

1. **Clone** the repository or copy the source files.
2. **Ensure** `kaizen.h` is in your include path.
3. **Compile** the program using your favorite C++ compiler. For example:

   ```bash
   g++ -std=c++17 -O2 main.cpp -o matrix_transpose
   ```
   - If you encounter filesystem linking issues on older systems, you may need to explicitly link against `stdc++fs`:
     ```bash
     g++ -std=c++17 -O2 main.cpp -lstdc++fs -o matrix_transpose
     ```

## Running the Program

You can run the program with default settings or customize the parameters using command-line options.

### 1. Default Run

```bash
./matrix_transpose
```

This will run a transposition on a default 1024×1024 matrix, performing both a naive and blocked transposition with block sizes 8, 16, 32, and 64.

### 2. Custom Matrix Size

```bash
./matrix_transpose --size 2048
```

This runs the same set of transpositions, but on a 2048×2048 matrix.

### 3. Custom Block Sizes

```bash
./matrix_transpose --block-sizes 16,32,64,128
```

This uses the default 1024×1024 matrix size, but with custom block sizes.

### 4. Combining Options

```bash
./matrix_transpose --size 512 --block-sizes 8,16
```

This runs the transposition on a 512×512 matrix with block sizes of 8 and 16.

## Output Example

Below is a sample output generated by running a default configuration:

```plaintext
=== Matrix Transposition Benchmark ===
Matrix Dimension: 1024 x 1024

Method                   Block Size     Time (ms)
=======================================================
Naive Transposition      N/A            150
Blocked Transposition    8              80     OK
Blocked Transposition    16             70     OK
Blocked Transposition    32             65     OK
Blocked Transposition    64             68     OK

Benchmark completed.
```

- **Naive Transposition** timing is shown first.
- **Blocked Transposition** results follow, with each chosen block size, its measured time, and a verification status (`OK` if the result matches the naive transposition).

Experiment with different matrix sizes and block sizes to see how performance changes based on cache utilization and your specific hardware configuration.

## License

This project is released under the [MIT License](LICENSE). Feel free to modify, distribute, and use it for your own purposes. Contributions and feedback are welcome!
